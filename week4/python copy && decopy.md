###### tags: `python`

# python copy && decopy

## 簡介

平常我們在將兩個陣列做相等的時候，常常會直接=過去，但是這個時候他的id是會相同的，那我們又該如何使它兩個陣列的id並不相等呢？相等又會有什麼影響呢？

## 影響

先用=來測試一下兩個陣列的id是否會相等吧～

```python=
>>> a=[1,2,3,4,5]
>>> b=a
>>> id(a)
140373246825480
>>> id(b)
140373246825480
>>> id(a)==id(b)
True
```

從這邊來看，直接做等號他們的id會是相等的，也就是說，當你更改到其中一個變數裡頭的值時，令一個也會跟著變動。

```python=
>>> a
[1, 2, 3, 4, 5]
>>> b
[1, 2, 3, 4, 5]
>>> b[0]=213
>>> a
[213, 2, 3, 4, 5]
>>> b
[213, 2, 3, 4, 5]
```

從這邊來看可以看出當我去更改b的值的時候，a也會跟著一起被改動，這也就是當id相同時，會產生的詭異之處，所以這時候需要用到copy跟deepcopy

## copy and deepcopy

copy 與 deepcopy 都是套件copy裡面的函數，所以當我們在使用時，需要去將它給引用進來。而這兩個的差異就在於，deepcopy會去將要複製的物體進行完全複製，也就是會建立一個完完全全的新個體，與原本物件沒有任何關係。

### decopy

其實deepcopy沒什麼好說的，它就是會去創造一個新的物體來將目標物體給複製過去，然後新的物體，跟舊的物體沒有任何的關聯性，也就變成了一個只是初始資料一樣，但是卻沒有任何相關的物體。


### copy

copy可以分成兩個方向討論，第一個是不可變物件，第二個是可變物件。

#### 不可變物件

不可變物件也就是所謂的數值、字串、元組。當遇到不可變物件他的功能會跟```=```一樣，直接去複製原本的id

```python=
>>> a="1234567"
>>> b=a
>>> id(a)
4367619440
>>> id(b)
4367619440
>>> c=copy.copy(a)
>>> id(c)
4367619440
>>> d=copy.deepcopy(a)
>>> id(d)
4367619440
```

#### 可變物件

當要複製的對象是可變物件時（陣列、字典），會產生兩種情況：
- 複製的物件中沒有其他子物件
    - 原來的id與複製後的id不同
    - 更改原物件不會影響複製物件
    - 反之亦然
- 複製的物件中有其他子物件
    - 不更改子物件時，兩者id不同不會互相影響
    - 更改子物件，原本子物件中的數值，會影響複製後的物件

所謂的子物件，也就是在原本物件中，在多一層物件出來，像是下面的例子中，```[a,d]```也就是他的子物件。
```python=
a=[12,3,[a,d]]
```


### 示範

```python=
>>> import copy
>>> list1=[0,1,2,['3a','3b']]
>>> list2=list1
>>> list3=copy.copy(list2)
>>> list4=copy.deepcopy(list3)
>>> id(list1)
140330182394696
>>> id(list2)
140330182394696
>>> id(list3)
140330182490696
>>> id(list4)
140330182488840
>>> list1[2].append('a')
>>> list1[3].append('a')
>>> print list1
print(list1)?
>>> print(list1)
[0, 1, 2, ['3a', '3b', 'a']]
>>> print(list2)
[0, 1, 2, ['3a', '3b', 'a']]
>>> print(list3)
[0, 1, 2, ['3a', '3b', 'a']]
>>> print(list4)
[0, 1, 2, ['3a', '3b']]
>>> list1.append(33)
>>> id(list1)
140330182394696
>>> id(list3)
140330182490696
>>> print(list1)
[0, 1, 2, ['3a', '3b', 'a'], 33]
>>> print(list3)
[0, 1, 2, ['3a', '3b', 'a']]
```

從這邊的舉例便可以清楚的去看出，copy與deepcopy的差別與用途